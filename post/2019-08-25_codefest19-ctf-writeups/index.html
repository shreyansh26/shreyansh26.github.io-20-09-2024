<!DOCTYPE html>
<html lang="en-us">

<head>

  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="generator" content="Source Themes Academic 4.6.2">

  

  
  
  
  
  
    
    
    
  
  

  <meta name="author" content="Shreyansh Singh">

  
  
  
    
  
  <meta name="description" content="The Capture the Flag event for Codefest’19 was hosted from 8 pm, 23rd August 2019 to 12 noon, 24th August 2019 on Hackerrank.
The contest link can be found here. There were a total of 1532 registrations and 518 people who were successful in solving atleast one challenge.
So, onto the writeups.
Welcome to Codefest 19! (Intro Challenge — 100pts) This was the introductory challenge. I had tried to make it a bit difficult than the normal introductory challenges, but I felt that it proved to be a bit difficult for the beginners.">

  
  <link rel="alternate" hreflang="en-us" href="/post/2019-08-25_codefest19-ctf-writeups/">

  


  
  
  
  <meta name="theme-color" content="#3f51b5">
  

  
  
  
  
    
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/academicons/1.8.6/css/academicons.min.css" integrity="sha256-uFVgMKfistnJAfoCUQigIl+JfUaP47GrRKjf6CTPVmw=" crossorigin="anonymous">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.11.2/css/all.min.css" integrity="sha256-+N4/V/SbAFiW1MPBCXnfnP9QSN3+Keu+NlB+0ev/YKQ=" crossorigin="anonymous">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/fancybox/3.5.7/jquery.fancybox.min.css" integrity="sha256-Vzbj7sDDS/woiFS3uNKo8eIuni59rjyNGtXfstRzStA=" crossorigin="anonymous">

    
    
    
      
    
    
      
      
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.15.10/styles/github.min.css" crossorigin="anonymous" title="hl-light">
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.15.10/styles/github.min.css" crossorigin="anonymous" title="hl-dark" disabled>
      
    

    
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/leaflet/1.5.1/leaflet.css" integrity="sha256-SHMGCYmST46SoyGgo4YR/9AlK1vf3ff84Aq9yK4hdqM=" crossorigin="anonymous">
    

    

  

  
  
  
  <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=B612+Mono:400,700%7COrbitron:400,700%7CSpace+Mono:400,700%7CLato%7CMontserrat%7CInconsolata%7COpen+Sans&display=swap">
  

  
  
  
  
  <link rel="stylesheet" href="/css/academic.css">

  





<script async src="https://www.googletagmanager.com/gtag/js?id=UA-153509490-1"></script>
<script>
  window.dataLayer = window.dataLayer || [];

  function gtag() {
      dataLayer.push(arguments);
  }

  function trackOutboundLink(url) {
    gtag('event', 'click', {
         'event_category': 'outbound',
         'event_label': url,
         'transport_type': 'beacon',
         'event_callback': function () {
           document.location = url;
         }
    });
    console.debug("Outbound link clicked: " + url);
  }

  function onClickCallback(event) {
    if ((event.target.tagName !== 'A') || (event.target.host === window.location.host)) {
      return;
    }
    trackOutboundLink(event.target);  
  }

  gtag('js', new Date());
  gtag('config', 'UA-153509490-1', {});

  
  document.addEventListener('click', onClickCallback, false);
</script>


  


  

  <link rel="manifest" href="/index.webmanifest">
  <link rel="icon" type="image/png" href="/img/shreyansh-icon-32.png">
  <link rel="apple-touch-icon" type="image/png" href="/img/shreyansh-icon-192.png">

  <link rel="canonical" href="/post/2019-08-25_codefest19-ctf-writeups/">

  
  
  
  
    
  
  
  <meta property="twitter:card" content="summary_large_image">
  
  <meta property="twitter:site" content="@shreyansh_26">
  <meta property="twitter:creator" content="@shreyansh_26">
  
  <meta property="og:site_name" content="Shreyansh Singh">
  <meta property="og:url" content="/post/2019-08-25_codefest19-ctf-writeups/">
  <meta property="og:title" content="Codefest’19 CTF Writeups | Shreyansh Singh">
  <meta property="og:description" content="The Capture the Flag event for Codefest’19 was hosted from 8 pm, 23rd August 2019 to 12 noon, 24th August 2019 on Hackerrank.
The contest link can be found here. There were a total of 1532 registrations and 518 people who were successful in solving atleast one challenge.
So, onto the writeups.
Welcome to Codefest 19! (Intro Challenge — 100pts) This was the introductory challenge. I had tried to make it a bit difficult than the normal introductory challenges, but I felt that it proved to be a bit difficult for the beginners."><meta property="og:image" content="/post/2019-08-25_codefest19-ctf-writeups/featured.png">
  <meta property="twitter:image" content="/post/2019-08-25_codefest19-ctf-writeups/featured.png"><meta property="og:locale" content="en-us">
  
    
      <meta property="article:published_time" content="2019-08-25T19:13:05&#43;00:00">
    
    <meta property="article:modified_time" content="2019-11-29T21:04:46&#43;05:30">
  

  


    






  






<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "BlogPosting",
  "mainEntityOfPage": {
    "@type": "WebPage",
    "@id": "/post/2019-08-25_codefest19-ctf-writeups/"
  },
  "headline": "Codefest’19 CTF Writeups",
  
  "image": [
    "/post/2019-08-25_codefest19-ctf-writeups/featured.png"
  ],
  
  "datePublished": "2019-08-25T19:13:05Z",
  "dateModified": "2019-11-29T21:04:46+05:30",
  
  "author": {
    "@type": "Person",
    "name": "Shreyansh Singh"
  },
  
  "publisher": {
    "@type": "Organization",
    "name": "Shreyansh Singh",
    "logo": {
      "@type": "ImageObject",
      "url": "/img/shreyansh-icon-512.png"
    }
  },
  "description": "The Capture the Flag event for Codefest’19 was hosted from 8 pm, 23rd August 2019 to 12 noon, 24th August 2019 on Hackerrank.\nThe contest link can be found here. There were a total of 1532 registrations and 518 people who were successful in solving atleast one challenge.\nSo, onto the writeups.\nWelcome to Codefest 19! (Intro Challenge — 100pts) This was the introductory challenge. I had tried to make it a bit difficult than the normal introductory challenges, but I felt that it proved to be a bit difficult for the beginners."
}
</script>

  

  


  


  

<style>

    @font-face {
        font-family: monaco123;
        font-weight: 100%;
        font-style: normal;
        src: url("/fonts/MONACO.TTF");
    } 

    code {
        font-family: monaco123;
        font-size: 100%;
    }

</style>


  <title>Codefest’19 CTF Writeups | Shreyansh Singh</title>

</head>

<body id="top" data-spy="scroll" data-offset="70" data-target="#TableOfContents" >

  <aside class="search-results" id="search">
  <div class="container">
    <section class="search-header">

      <div class="row no-gutters justify-content-between mb-3">
        <div class="col-6">
          <h1>Search</h1>
        </div>
        <div class="col-6 col-search-close">
          <a class="js-search" href="#"><i class="fas fa-times-circle text-muted" aria-hidden="true"></i></a>
        </div>
      </div>

      <div id="search-box">
        
        <input name="q" id="search-query" placeholder="Search..." autocapitalize="off"
        autocomplete="off" autocorrect="off" spellcheck="false" type="search">
        
      </div>

    </section>
    <section class="section-search-results">

      <div id="search-hits">
        
      </div>

    </section>
  </div>
</aside>


  
<nav class="navbar navbar-expand-lg navbar-light compensate-for-scrollbar" id="navbar-main">
  <div class="container">

    
    
    
      <a class="navbar-brand" href="/">Shreyansh Singh</a>
    

    
    <button type="button" class="navbar-toggler" data-toggle="collapse"
            data-target="#navbar-content" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
    <span><i class="fas fa-bars"></i></span>
    </button>
    

    
    
    <div class="navbar-collapse main-menu-item collapse justify-content-start" id="navbar-content">

      
      <ul class="navbar-nav d-md-inline-flex">
        

        

        
        
        
          
        

        
        
        
        
        
        
          
          
          
            
          
          
        

        <li class="nav-item">
          <a class="nav-link " href="/#about"><span>Home</span></a>
        </li>

        
        

        

        
        
        
          
        

        
        
        
        
        
        

        <li class="nav-item">
          <a class="nav-link  active" href="/post/"><span>Posts</span></a>
        </li>

        
        

        

        
        
        
          
        

        
        
        
        
        
        
          
          
          
            
          
          
        

        <li class="nav-item">
          <a class="nav-link " href="/#projects"><span>Projects</span></a>
        </li>

        
        

        

        
        
        
          
        

        
        
        
        
        
        
          
          
          
            
          
          
        

        <li class="nav-item">
          <a class="nav-link " href="/#contact"><span>Contact</span></a>
        </li>

        
        

        

        
        
        
          
        

        
        
        
        
        
        

        <li class="nav-item">
          <a class="nav-link " href="/files/Shreyansh_Resume.pdf"><span>CV</span></a>
        </li>

        
        

      

        
      </ul>
    </div>

    <ul class="nav-icons navbar-nav flex-row ml-auto d-flex pl-md-2">
      
      <li class="nav-item">
        <a class="nav-link js-search" href="#"><i class="fas fa-search" aria-hidden="true"></i></a>
      </li>
      

      
      <li class="nav-item">
        <a class="nav-link js-dark-toggle" href="#"><i class="fas fa-moon" aria-hidden="true"></i></a>
      </li>
      

      

    </ul>

  </div>
</nav>


  <article class="article">

  




















  
  
    
  


<div class="article-container pt-3">
  <h1>Codefest’19 CTF Writeups</h1>

  
  <p class="page-subtitle">The Capture the Flag event for Codefest’19 was hosted from 8 pm, 23rd August 2019 to 12 noon, 24th August 2019 on Hackerrank.</p>
  

  


<div class="article-metadata">

  
  

  
  <span class="article-date">
    
    
      
          Last updated on
      
    
    Nov 29, 2019
  </span>
  

  

  
  <span class="middot-divider"></span>
  <span class="article-reading-time">
    6 min read
  </span>
  

  
  
  
  <span class="middot-divider"></span>
  <a href="/post/2019-08-25_codefest19-ctf-writeups/#disqus_thread"></a>
  

  
  
  <span class="middot-divider"></span>
  <span class="article-categories">
    <i class="fas fa-folder mr-1"></i><a href="/categories/information-security/">Information Security</a></span>
  

</div>

  














</div>


<div class="article-header article-container featured-image-wrapper mt-4 mb-4" style="max-width: 720px; max-height: 237px;">
  <div style="position: relative">
    <img src="/post/2019-08-25_codefest19-ctf-writeups/featured_huc3c13dd8dd15ac64b7084b45c76a3fff_35040_720x0_resize_lanczos_2.png" alt="" class="featured-image">
    <span class="article-header-caption">Codefest 2019</span>
  </div>
</div>



  <div class="article-container">

    <div class="article-style">
      <p>The Capture the Flag event for <a href="http://codefest.tech">Codefest’19</a> was hosted from 8 pm, 23rd August 2019 to 12 noon, 24th August 2019 on Hackerrank.</p>
<p>The contest link can be found <a href="https://www.hackerrank.com/codefest19-ctf">here</a>. There were a total of <strong>1532</strong> registrations and <strong>518</strong> people who were successful in solving atleast one challenge.</p>
<p>So, onto the writeups.</p>
<h3 id="welcome-to-codefest-19-intro-challenge100pts"><strong>Welcome to Codefest 19! (Intro Challenge — 100pts)</strong></h3>
<p>This was the introductory challenge. I had tried to make it a bit difficult than the normal introductory challenges, but I felt that it proved to be a bit difficult for the beginners.</p>













<figure>


  <a data-fancybox="" href="/post/2018-03-23_angstromctf-writeups/images/13.png" data-caption="The challenge">
<img src="/post/2018-03-23_angstromctf-writeups/images/13.png" alt="" ></a>


  
  
  <figcaption>
    The challenge
  </figcaption>


</figure>

<p>Here, first you had to join the telegram group linked in the proble. There you got the first half of the flag — **CodefestCTF{G3t_r3ady_**. For the other half there was a pinned message on the group.</p>
<blockquote>
<p>The other half of the flag was uploaded on the contest page yesterday by accident. It has now been removed. Can you find it?</p>
</blockquote>
<p>For this you had to use <a href="http://archive.org">archive.org,</a> there was a snapshot of the contest page created on 23rd Aug 2019. Viewing the <a href="https://web.archive.org/web/20190823133528/https://www.hackerrank.com/codefest19-ctf">snapshot</a> got you the second half of the flag —<strong>f0r_C0def3stCTF-8fb34fjr4bs43ur8}</strong>.</p>
<p>So, the final flag is — <strong>CodefestCTF{G3t_r3ady_f0r_C0def3stCTF-8fb34fjr4bs43ur8}</strong></p>
<p> </p>
<h3 id="what-language-is-this-misc100pts">What language is this? (Misc — 100pts)</h3>
<p>This was basically a esoteric language question. The given text was —</p>
<pre><code>iiisdsiiioiiiiiiiiiiiiiiiiiiiiiiiiiiiiiiiiiiiiiiiiiiiiodddddddddddoioiodoiiiiiiiiiiiiiioiodddddddddddddddddddddddddddddddddddddddddddddddddoiiiiiiiiiiiiiiiiioddddddddddddddoiiiiiiiiiiiiiiiiiiiiiiiiiiiiiiiiiiiiiiiiiiiiiiiiiiiiioddddddddddddddddddddddddddddddddddddoiiiiiiiiiiiiiioiiiiiiiodddddddddodddddddddddddddddddddddddddddddddddddddddddddddddddoddddddddddddddddddddddddddddddddddddddsiiiiiiiiioddddddddoddddddoiiiiiiiiiiiiiiiiiiiiioddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddoddddddddddddddddddddddddddddddddsiiisisdddddoddddddddddddddddddddddddddddodddddddddddddddddddoddddddddddddddddddddddddddddddddsiiisisoioiodoiiiiiiiiiiiiiioiodddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddoiiiiiiiioddddddddddddddddddddddddddddddddddddddddddddddsiiiio
</code></pre><p>The language was <a href="https://esolangs.org/wiki/Deadfish">Deadfish</a>. You could use an online decoder for that language, something like <a href="https://www.dcode.fr/deadfish-language">this</a>.</p>
<p>The final flag was — <strong>CodefestCTF{Welc0me_t0_C0defest19}</strong></p>
<p> </p>
<h3 id="gibberish-file-misc100pts">Gibberish file (Misc — 100pts)</h3>













<figure>


  <a data-fancybox="" href="/post/2019-08-25_codefest19-ctf-writeups/images/2.png" data-caption="The challenge">
<img src="/post/2019-08-25_codefest19-ctf-writeups/images/2.png" alt="" ></a>


  
  
  <figcaption>
    The challenge
  </figcaption>


</figure>

<p>The hint was in the problem statement. You had to reverse the file to find the flag. A simple one-line script could do it</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">open(<span style="color:#e6db74"></span><span style="color:#e6db74">&#34;</span><span style="color:#e6db74">output2.txt</span><span style="color:#e6db74">&#34;</span>, <span style="color:#e6db74"></span><span style="color:#e6db74">&#34;</span><span style="color:#e6db74">wb</span><span style="color:#e6db74">&#34;</span>)<span style="color:#f92672">.</span>write(open(<span style="color:#e6db74"></span><span style="color:#e6db74">&#34;</span><span style="color:#e6db74">output.txt</span><span style="color:#e6db74">&#34;</span>, <span style="color:#e6db74"></span><span style="color:#e6db74">&#34;</span><span style="color:#e6db74">rb</span><span style="color:#e6db74">&#34;</span>)<span style="color:#f92672">.</span>read()[::<span style="color:#f92672">-</span><span style="color:#ae81ff">1</span>])
</code></pre></div><p>The resulting had some text like</p>
<blockquote>
<p>𝝩𝗵𝙚 𝗳𝒍𝙖𝗴 𝒊𝙨 𝐋𝒊𝐓𝚬𝐫𝚨𝐋﹏𝕽𝜠𝓥Ｅℜ𝕊𝐢𝙣𝓖ꓸ 𝝩𝗵𝙚 𝗳𝒍𝙖𝗴 𝒊𝙨 𝐋𝒊𝐓𝚬𝐫𝚨𝐋﹏𝕽𝜠𝓥Ｅℜ𝕊𝐢𝙣𝓖ꓸ 𝝩𝗵𝙚 𝗳𝒍𝙖𝗴 𝒊𝙨 𝐋𝒊𝐓𝚬𝐫𝚨𝐋﹏𝕽𝜠𝓥Ｅℜ𝕊𝐢𝙣𝓖ꓸ 𝝩𝗵𝙚 𝗳𝒍𝙖𝗴 𝒊𝙨 𝐋𝒊𝐓𝚬𝐫𝚨𝐋﹏𝕽𝜠𝓥Ｅℜ𝕊𝐢𝙣𝓖ꓸ 𝝩𝗵𝙚 𝗳𝒍𝙖𝗴 𝒊𝙨 𝐋𝒊𝐓𝚬𝐫𝚨𝐋﹏𝕽𝜠𝓥Ｅℜ𝕊𝐢𝙣𝓖ꓸ 𝝩𝗵𝙚 𝗳𝒍𝙖𝗴 𝒊𝙨 𝐋𝒊𝐓𝚬𝐫𝚨𝐋﹏𝕽𝜠𝓥Ｅℜ𝕊𝐢𝙣𝓖ꓸ 𝝩𝗵𝙚 𝗳𝒍𝙖𝗴 𝒊𝙨 𝐋𝒊𝐓𝚬𝐫𝚨𝐋﹏𝕽𝜠𝓥Ｅℜ𝕊𝐢𝙣𝓖ꓸ 𝝩𝗵𝙚 𝗳𝒍𝙖𝗴 𝒊𝙨 𝐋𝒊𝐓𝚬𝐫𝚨𝐋﹏𝕽𝜠𝓥Ｅℜ𝕊𝐢𝙣𝓖ꓸ 𝝩𝗵𝙚 𝗳𝒍𝙖𝗴 𝒊𝙨 𝐋𝒊𝐓𝚬𝐫𝚨𝐋﹏𝕽𝜠𝓥Ｅℜ𝕊𝐢𝙣𝓖ꓸ 𝝩𝗵𝙚 𝗳𝒍𝙖𝗴 𝒊𝙨 𝐋𝒊𝐓𝚬𝐫𝚨𝐋﹏𝕽𝜠𝓥Ｅℜ𝕊𝐢𝙣𝓖ꓸ 𝝩𝗵𝙚 𝗳𝒍𝙖𝗴 𝒊𝙨 𝐋𝒊𝐓𝚬𝐫𝚨𝐋﹏𝕽𝜠𝓥Ｅℜ𝕊𝐢𝙣𝓖ꓸ 𝝩𝗵𝙚 𝗳𝒍𝙖𝗴 𝒊𝙨 𝐋𝒊𝐓𝚬𝐫𝚨𝐋﹏𝕽𝜠𝓥Ｅℜ𝕊𝐢𝙣𝓖ꓸ 𝝩𝗵𝙚 𝗳𝒍𝙖𝗴 𝒊𝙨 𝐋𝒊𝐓𝚬𝐫𝚨𝐋﹏𝕽𝜠𝓥Ｅℜ𝕊𝐢𝙣𝓖ꓸ 𝝩𝗵𝙚 𝗳𝒍𝙖𝗴 𝒊𝙨 𝐋𝒊𝐓𝚬𝐫𝚨𝐋﹏𝕽𝜠𝓥Ｅℜ𝕊𝐢𝙣𝓖ꓸ 𝝩𝗵𝙚 𝗳𝒍𝙖𝗴 𝒊𝙨 𝐋𝒊𝐓𝚬𝐫𝚨𝐋﹏𝕽𝜠𝓥Ｅℜ𝕊𝐢𝙣𝓖ꓸ</p>
</blockquote>
<p>The flag was the ASCII analog of each unicode character.</p>
<p>The flag was — <strong>CodefestCTF{LiTErAL_REVERSinG}</strong></p>
<p> </p>
<h3 id="image-corruption-forensics100pts">Image Corruption (Forensics — 100pts)</h3>
<p>In the challenge, you were given a link to a corrupted <em>.bmp</em> <a href="https://drive.google.com/file/d/1t5d_lKkdoG1aicBJYhM8wqh7Ispk0G4U/view">file</a>. On viewing the file in a hex editor, and also checking the magic bytes —</p>













<figure>


  <a data-fancybox="" href="/post/2019-08-25_codefest19-ctf-writeups/images/3.png" data-caption="Hex view of the image">
<img src="/post/2019-08-25_codefest19-ctf-writeups/images/3.png" alt="" ></a>


  
  
  <figcaption>
    Hex view of the image
  </figcaption>


</figure>

<p>We know there is something to do with “matrix”. Also for a normal <em>.bmp</em> file the initial magic bytes are 424d 8a44 1300. XORing this with the first six bytes of the given file also gives you “matrix”. So to solve the challenge, we XOR the whole image with “matrix”.</p>
<script type="application/javascript" src="https://gist.github.com/shreyansh26/391d4103c8175cd3484c286d7c51dfd7.js"></script>

<p>Run the script, and you obtain the correct file.</p>













<figure>


  <a data-fancybox="" href="/post/2019-08-25_codefest19-ctf-writeups/images/4.jpeg" data-caption="The correct file">
<img src="/post/2019-08-25_codefest19-ctf-writeups/images/4.jpeg" alt="" ></a>


  
  
  <figcaption>
    The correct file
  </figcaption>


</figure>

<p>The flag is — <strong>CodefestCTF{f1l35_h4v3_m461c_by735}</strong></p>
<p> </p>
<h3 id="mail-capture-steganography-100pts">Mail capture (Steganography— 100pts)</h3>
<p>You are presented with a “email friendly text”. This was encoded to unicode by a tool called <strong>uuencode</strong>. It can be decoded by using <strong>uudecode</strong>, a decoder for such formats. Running <strong>uudecode</strong> with the file gives an output file called “flag_encoded”. The contents are the flag — <strong>CodefestCTF{7h15_15_4_c001_3nc0d1n9}</strong></p>
<p> </p>
<h3 id="cats-are-innocent-right-steganography-500pts">Cats are innocent, right? (Steganography— 500pts)</h3>
<p>This challenge was based on LSB steganography. I had used a tool called <a href="https://github.com/DimitarPetrov/stegify"><strong>stegify</strong></a>.</p>
<p>The challenge image -</p>













<figure>


  <a data-fancybox="" href="/post/2019-08-25_codefest19-ctf-writeups/images/5.jpeg" data-caption="Challenge image">
<img src="/post/2019-08-25_codefest19-ctf-writeups/images/5.jpeg" alt="" ></a>


  
  
  <figcaption>
    Challenge image
  </figcaption>


</figure>

<p>On running the command -</p>
<blockquote>
<p>stegify -op decode -carrier cute_kittens.jpg -result hello</p>
</blockquote>
<p>We get a <em>hello.zip</em> file which was embedded in the LSBs of the image. The zip file had a file inside it but that was of no use. The flag was appended at the end of the zip file.</p>













<figure>


  <a data-fancybox="" href="/post/2019-08-25_codefest19-ctf-writeups/images/6.png" >
<img src="/post/2019-08-25_codefest19-ctf-writeups/images/6.png" alt="" ></a>



</figure>

<p>The flag is appended at the end of the zip file</p>
<p>The flag is — <strong>CodefestCTF{h1d1ng_b3h1nd_1nn0c3nt_k1tt3n5}</strong></p>
<p> </p>
<h3 id="weird-encoding-misc-200pts">Weird encoding (Misc— 200pts)</h3>













<figure>


  <a data-fancybox="" href="/post/2019-08-25_codefest19-ctf-writeups/images/7.png" data-caption="The challenge">
<img src="/post/2019-08-25_codefest19-ctf-writeups/images/7.png" alt="" ></a>


  
  
  <figcaption>
    The challenge
  </figcaption>


</figure>

<p>We are given the following “encoding”</p>
<pre><code>0x85+1x1+0x14
0x7+1x1+0x7+1x1+0x9+1x2+0x3+1x4+0x3+1x1+0x6+1x5+0x1+1x1+0x2+1x1+0x1+1x2+0x13+1x2+0x3+1x1+0x8+1x1+0x5+1x2+0x8
0x1+1x5+0x18+1x3+0x3+1x1+0x16+1x2+0x1+1x1+0x5+1x2+0x2+1x1+0x3+1x1+0x4+1x2+0x3+1x3+0x3+1x1+0x2+1x2+0x4+1x3+0x8
0x3+1x1+0x7+1x1+0x11+1x2+0x1+1x1+0x3+1x5+0x12+1x1+0x2+1x1+0x7+1x1+0x10+1x1+0x3+1x2+0x1+1x1+0x5+1x3+0x4+1x1+0x1+1x2+0x2+1x1+0x4
0x3+1x1+0x3+1x1+0x7+1x2+0x3+1x1+0x2+1x1+0x2+1x1+0x7+1x1+0x11+1x2+0x2+1x2+0x5+1x2+0x10+1x1+0x3+1x1+0x2+1x1+0x3+1x2+0x2+1x1+0x4+1x4+0x7
0x3+1x1+0x3+1x1+0x3+1x1+0x1+1x3+0x10+1x1+0x7+1x1+0x7+1x1+0x3+1x1+0x3+1x1+0x1+1x2+0x2+1x3+0x8+1x5+0x4+1x1+0x3+1x9+0x1+1x3+0x7
0x3+1x1+0x3+1x3+0x1+1x1+0x1+1x4+0x9+1x1+0x6+1x2+0x2+1x1+0x7+1x2+0x3+1x1+0x2+1x1+0x4+1x1+0x10+1x1+0x6+1x1+0x7+1x1+0x7+1x4+0x4
0x5+1x1+0x1+1x1+0x1+1x1+0x1+1x1+0x4+1x2+0x7+1x2+0x3+1x4+0x11+1x1+0x4+1x1+0x2+1x1+0x3+1x2+0x6+1x1+0x3+1x1+0x6+1x1+0x7+1x1+0x1+1x1+0x1+1x5+0x7
0x7+1x1+0x1+1x1+0x1+1x1+0x2+1x3+0x7+1x5+0x16+1x1+0x4+1x1+0x2+1x1+0x1+1x3+0x3+1x6+0x2+1x1+0x2+1x1+0x1+1x5+0x5+1x1+0x2+1x1+0x4+1x1+0x7
0x18+1x5+0x13+1x6+0x27+1x1+0x14+1x1+0x2+1x2+0x2+1x1+0x5+1x1+0x2
0x1+1x1+0x5+1x1+0x4+1x1+0x3+1x1+0x8+1x1+0x8+1x1+0x9+1x1+0x8+1x1+0x5+1x1+0x17+1x1+0x10+1x3+0x9
0x68+1x1+0x11+1x1+0x19

</code></pre><p>Here a bit of observation was required to figure out that the “x” symbol mean concatenation <em>n</em> number of a character, like 0x5 will mean 00000. And “+” would mean concatenation of two strings of different type. Also, one will also have to decide on 0 representing 255 255 255 i.e. the color <em>white</em> and 1 representing 0 0 0 , i.e. the color <em>black</em>. You could have experimented with both combinations but eventually you would get the correct mapping.</p>
<p>The following script can help generate the image.</p>
<script type="application/javascript" src="https://gist.github.com/shreyansh26/9f262ca29ec6bcb5c8b66e1feb95cf6e.js"></script>

<p>The obtained image is this -</p>













<figure>


  <a data-fancybox="" href="/post/2019-08-25_codefest19-ctf-writeups/images/8.png" data-caption="You may want to zoom in a bit">
<img src="/post/2019-08-25_codefest19-ctf-writeups/images/8.png" alt="" ></a>


  
  
  <figcaption>
    You may want to zoom in a bit
  </figcaption>


</figure>

<p>The flag is — <strong>CodefestCTF{This_15_7h3_f14g}</strong>.</p>
<p> </p>
<h3 id="linux-re-1-reversing300pts">Linux RE 1 (Reversing — 300pts)</h3>
<p>This challenge was a bit difficult to solve using a debugger due to some anti-debugging techniques that were implemented. Also, initially the ELF was packed using UPX, which was visible as a string when you would have run the <strong>strings</strong> command. So, first use</p>
<blockquote>
<p>upx -d</p>
</blockquote>
<p>with the ELF to decompress it.</p>
<p>For the next part, You could use a disassembler or a decompiler to get the source code and eventually reverse the binary. The executable was generated from a C++ file hence it was a bit messy to view in a decompiler.</p>
<p>The decompiled view (using Ghidra) of the main function (the interesting part) is the following -</p>













<figure>


  <a data-fancybox="" href="/post/2019-08-25_codefest19-ctf-writeups/images/9.png" data-caption="Decompiled main function">
<img src="/post/2019-08-25_codefest19-ctf-writeups/images/9.png" alt="" ></a>


  
  
  <figcaption>
    Decompiled main function
  </figcaption>


</figure>

<p>The <em>key_int</em> and <em>enc_int</em> are global variables. The main logic of the ELF is in the <strong>rahasya</strong> function.</p>













<figure>


  <a data-fancybox="" href="/post/2019-08-25_codefest19-ctf-writeups/images/10.png" data-caption="Decompiled rahasya function">
<img src="/post/2019-08-25_codefest19-ctf-writeups/images/10.png" alt="" ></a>


  
  
  <figcaption>
    Decompiled rahasya function
  </figcaption>


</figure>

<p>This basically takes two strings and XORs them and returns the XORd string. The two strings it takes as input are the user input and the <em>key_int</em> string. The XORd data is matched with the <em>enc_int</em> data.</p>
<p>So, basically to reverse the binary you have to XOR both the <em>key_int</em> and <em>enc_int</em> data.</p>













<figure>


  <a data-fancybox="" href="/post/2019-08-25_codefest19-ctf-writeups/images/11.png" data-caption="enc_int data">
<img src="/post/2019-08-25_codefest19-ctf-writeups/images/11.png" alt="" ></a>


  
  
  <figcaption>
    enc_int data
  </figcaption>


</figure>














<figure>


  <a data-fancybox="" href="/post/2019-08-25_codefest19-ctf-writeups/images/12.png" data-caption="key_int data">
<img src="/post/2019-08-25_codefest19-ctf-writeups/images/12.png" alt="" ></a>


  
  
  <figcaption>
    key_int data
  </figcaption>


</figure>

<p>Basically,</p>
<blockquote>
<p>int <em>enc_int[]</em> = {80, 93, 3, 67, 3, 86, 11, 110, 64, 2, 90, 27, 84, 28, 110, 75, 3, 69, 52, 6, 11, 5, 80, 88, 90, 88};</p>
</blockquote>
<blockquote>
<p>int <em>key_int[]</em> = {49, 51, 51, 55, 107, 101, 121};</p>
</blockquote>
<p>XOR both of them, and you get <em>an0th3r_s1mp1e_x0r_cr4ckm3</em></p>
<p>So, the flag is <strong>CodefestCTF{an0th3r_s1mp1e_x0r_cr4ckm3}</strong></p>
<p> </p>
<h3 id="linux-re-2-reversing500pts">Linux RE 2 (Reversing — 500pts)</h3>
<p>Again we open the file in IDA or any disassembler and/or decompiler we see that the input should satisfy a set of conditions on the letters of the input.</p>
<p>The conditions can be translated as</p>
<script type="application/javascript" src="https://gist.github.com/shreyansh26/c0c225fa5daa05da85bb0534dc5438a9.js"></script>

<p>We can use some kind of SMT solver like z3 to find the password.</p>
<script type="application/javascript" src="https://gist.github.com/shreyansh26/bccc43909e68ddd7d219f59fc48da4c5.js"></script>

<p>The obtained password is — <em>shouldve_used_some_tool</em></p>
<p>The flag, hence, is <strong>CodefestCTF{shouldve_used_some_tool}</strong></p>
<p> </p>
<h3 id="windows-re-reversing500pts">Windows RE (Reversing — 500pts)</h3>
<p>In this problem, the Windows exe file (actually a .NET file) that was provided, was packed with <a href="https://yck1509.github.io/ConfuserEx/">ConfuserEx</a>. We can use <a href="https://github.com/CodeShark-Dev/NoFuserEx">NoFuserEx,</a> which is a free deobfuscator for this packer.</p>
<p>Then, open the executable in any .NET decompiler like dnSpy and check the <strong>Form</strong> function to get the password as well as the flag.</p>
<blockquote>
<p>Password — thisisa1337password</p>
</blockquote>
<p>The flag — <strong>CodefestCTF{51mp13_1npu7_v411d4710n_8u7_w17h_4_7w157}</strong></p>
<p> </p>
<h3 id="no-fatshaming-web600pts">No Fatshaming (Web — 600pts)</h3>
<p>I’ll cheat a bit here xD. You can read my friend Yashit’s <a href="https://medium.com/@yashitmaheshwary/no-fatshaming-web-challenge-writeup-codefest19-ctf-1deea5a2ea49">awesome writeup</a> on the challenge.</p>
<p>Flag is — <strong>CodefestCTF{1AmTeHHHAX00Rr4uj8rfi4e$%y5yhrf}</strong></p>
<p><em>Hope you had a great time solving the challenges and that it was a good learning experience for beginners.</em></p>
<p>Follow me on <a href="https://twitter.com/shreyansh_26">Twitter</a>, <a href="https://github.com/shreyansh26">Github</a> or connect on <a href="https://www.linkedin.com/in/shreyansh26/">LinkedIn</a>.</p>

    </div>

    





<div class="article-tags">
  
  <a class="badge badge-light" href="/tags/ctf/">ctf</a>
  
  <a class="badge badge-light" href="/tags/information-security/">information security</a>
  
  <a class="badge badge-light" href="/tags/infosec/">infosec</a>
  
  <a class="badge badge-light" href="/tags/writeups/">writeups</a>
  
</div>



<div class="share-box" aria-hidden="true">
  <ul class="share">
    
      
      
      
        
      
      
      
      <li>
        <a href="https://twitter.com/intent/tweet?url=/post/2019-08-25_codefest19-ctf-writeups/&amp;text=Codefest%e2%80%9919%20CTF%20Writeups" target="_blank" rel="noopener" class="share-btn-twitter">
          <i class="fab fa-twitter"></i>
        </a>
      </li>
    
      
      
      
        
      
      
      
      <li>
        <a href="https://www.facebook.com/sharer.php?u=/post/2019-08-25_codefest19-ctf-writeups/&amp;t=Codefest%e2%80%9919%20CTF%20Writeups" target="_blank" rel="noopener" class="share-btn-facebook">
          <i class="fab fa-facebook"></i>
        </a>
      </li>
    
      
      
      
        
      
      
      
      <li>
        <a href="mailto:?subject=Codefest%e2%80%9919%20CTF%20Writeups&amp;body=/post/2019-08-25_codefest19-ctf-writeups/" target="_blank" rel="noopener" class="share-btn-email">
          <i class="fas fa-envelope"></i>
        </a>
      </li>
    
      
      
      
        
      
      
      
      <li>
        <a href="https://www.linkedin.com/shareArticle?url=/post/2019-08-25_codefest19-ctf-writeups/&amp;title=Codefest%e2%80%9919%20CTF%20Writeups" target="_blank" rel="noopener" class="share-btn-linkedin">
          <i class="fab fa-linkedin-in"></i>
        </a>
      </li>
    
      
      
      
        
      
      
      
      <li>
        <a href="https://web.whatsapp.com/send?text=Codefest%e2%80%9919%20CTF%20Writeups%20/post/2019-08-25_codefest19-ctf-writeups/" target="_blank" rel="noopener" class="share-btn-whatsapp">
          <i class="fab fa-whatsapp"></i>
        </a>
      </li>
    
  </ul>
</div>












  






  
  
  
    
  
  
  <div class="media author-card content-widget-hr">
    
      
      <img class="portrait mr-3" src="/authors/admin/avatar_huf7b68353d7bcc081ff7af0a8e00b9689_37035_250x250_fill_q90_lanczos_center.jpg" alt="Avatar">
    

    <div class="media-body">
      <h5 class="card-title"><a href="/">Shreyansh Singh</a></h5>
      <h6 class="card-subtitle">Senior Undergraduate in Computer Science and Engineering</h6>
      <p class="card-text">My research interests include information security, specially binary analysis and also application of Machine Learning in security.</p>
      <ul class="network-icon" aria-hidden="true">
  
    
    
    
      
    
    
    
    
    
    <li>
      <a href="mailto:shreyansh.singh.cse16@iitbhu.ac.in" >
        <i class="fas fa-envelope"></i>
      </a>
    </li>
  
    
    
    
      
    
    
    
    
    
      
    
    <li>
      <a href="https://twitter.com/shreyansh_26" target="_blank" rel="noopener">
        <i class="fab fa-twitter"></i>
      </a>
    </li>
  
    
    
    
    
    
    
    
      
    
    <li>
      <a href="https://scholar.google.com/citations?user=x8LmoJIAAAAJ&amp;hl=en" target="_blank" rel="noopener">
        <i class="ai ai-google-scholar"></i>
      </a>
    </li>
  
    
    
    
      
    
    
    
    
    
      
    
    <li>
      <a href="https://github.com/shreyansh26" target="_blank" rel="noopener">
        <i class="fab fa-github"></i>
      </a>
    </li>
  
    
    
    
      
    
    
    
    
    
      
    
    <li>
      <a href="https://www.linkedin.com/in/shreyansh26/" target="_blank" rel="noopener">
        <i class="fab fa-linkedin"></i>
      </a>
    </li>
  
    
    
    
    
    
    
    
      
    
    <li>
      <a href="/files/Shreyansh_Resume.pdf" >
        <i class="ai ai-cv"></i>
      </a>
    </li>
  
</ul>

    </div>
  </div>




<section id="comments">
  
    
<div id="disqus_thread"></div>
<script>
  let disqus_config = function () {
    
    
    
  };
  (function() {
    if (["localhost", "127.0.0.1"].indexOf(window.location.hostname) != -1) {
      document.getElementById('disqus_thread').innerHTML = 'Disqus comments not available by default when the website is previewed locally.';
      return;
    }
    var d = document, s = d.createElement('script'); s.async = true;
    s.src = 'https://' + "shreyansh26-netlify-com" + '.disqus.com/embed.js';
    s.setAttribute('data-timestamp', +new Date());
    (d.head || d.body).appendChild(s);
  })();
</script>
<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
<a href="https://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>


  
</section>




<div class="article-widget">
  
<div class="post-nav">
  
  
  
  <div class="post-nav-item">
    <div class="meta-nav">Next</div>
    <a href="/post/2019-11-19_ritsec-ctf-2019/" rel="next">RITSEC CTF 2019</a>
  </div>
  
  
  
  <div class="post-nav-item">
    <div class="meta-nav">Previous</div>
    <a href="/post/2018-03-23_angstromctf-writeups/" rel="prev">AngstromCTF Writeups</a>
  </div>
  
</div>

</div>



  
  
  <div class="article-widget content-widget-hr">
    <h3>Related</h3>
    <ul>
      
      <li><a href="/post/2018-03-23_angstromctf-writeups/">AngstromCTF Writeups</a></li>
      
      <li><a href="/post/2018-02-27_neverlan-ctf-2018-writeups/">NeverLAN CTF 2018 Writeups</a></li>
      
      <li><a href="/project/nids/">Network Intrusion Detection in an Adversarial setting</a></li>
      
      <li><a href="/project/linux-malware/">Linux Malware detection using Machine Learning</a></li>
      
    </ul>
  </div>
  



  </div>
</article>

      

    
    

    
    
    
      <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
      <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery.imagesloaded/4.1.4/imagesloaded.pkgd.min.js" integrity="sha256-lqvxZrPLtfffUl2G/e7szqSvPBILGbwmsGE1MKlOi0Q=" crossorigin="anonymous"></script>
      <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery.isotope/3.0.6/isotope.pkgd.min.js" integrity="sha256-CBrpuqrMhXwcLLUd5tvQ4euBHCdh7wGlDfNz8vbu/iI=" crossorigin="anonymous"></script>
      <script src="https://cdnjs.cloudflare.com/ajax/libs/fancybox/3.5.7/jquery.fancybox.min.js" integrity="sha256-yt2kYMy0w8AbtF89WXb2P1rfjcP/HTHLT7097U8Y5b8=" crossorigin="anonymous"></script>

      

      
        
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.15.10/highlight.min.js" integrity="sha256-1zu+3BnLYV9LdiY85uXMzii3bdrkelyp37e0ZyTAQh0=" crossorigin="anonymous"></script>
        
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.15.10/languages/r.min.js"></script>
        
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.15.10/languages/python.min.js"></script>
        
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.15.10/languages/cpp.min.js"></script>
        
      

      
      
    

    
    
      <script src="https://cdnjs.cloudflare.com/ajax/libs/leaflet/1.5.1/leaflet.js" integrity="sha256-EErZamuLefUnbMBQbsEqu1USa+btR2oIlCpBJbyD4/g=" crossorigin="anonymous"></script>
    

    
    
    <script>const code_highlighting = true;</script>
    

    
    
    
    
    
    
    <script>
      const search_config = {"indexURI":"/index.json","minLength":1,"threshold":0.3};
      const i18n = {"no_results":"No results found","placeholder":"Search...","results":"results found"};
      const content_type = {
        'post': "Posts",
        'project': "Projects",
        'publication' : "Publications",
        'talk' : "Talks"
        };
    </script>
    

    
    

    
    
    <script id="search-hit-fuse-template" type="text/x-template">
      <div class="search-hit" id="summary-{{key}}">
      <div class="search-hit-content">
        <div class="search-hit-name">
          <a href="{{relpermalink}}">{{title}}</a>
          <div class="article-metadata search-hit-type">{{type}}</div>
          <p class="search-hit-description">{{snippet}}</p>
        </div>
      </div>
      </div>
    </script>
    

    
    
    <script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/3.2.1/fuse.min.js" integrity="sha256-VzgmKYmhsGNNN4Ph1kMW+BjoYJM2jV5i4IlFoeZA9XI=" crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/jquery.mark.min.js" integrity="sha256-4HLtjeVgH0eIB3aZ9mLYF6E8oU5chNdjU6p6rrXpl9U=" crossorigin="anonymous"></script>
    

    
    

    
    
    <script id="dsq-count-scr" src="https://shreyansh26-netlify-com.disqus.com/count.js" async></script>
    

    
    
    
    
    
    
    
    
    
      
    
    
    
    
    <script src="/js/academic.min.bcfae8267aba63cc55af53a503896bd9.js"></script>

    






  
  
  <div class="container">
    <footer class="site-footer">
  

  <p class="powered-by">
    © Shreyansh Singh 2019 &middot; 

    Powered by 
    
    <a href="https://gohugo.io" target="_blank" rel="noopener">Hugo</a>.

    
    <span class="float-right" aria-hidden="true">
      <a href="#" class="back-to-top">
        <span class="button_icon">
          <i class="fas fa-chevron-up fa-2x"></i>
        </span>
      </a>
    </span>
    
  </p>
</footer>

  </div>
  

  
<div id="modal" class="modal fade" role="dialog">
  <div class="modal-dialog">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title">Cite</h5>
        <button type="button" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <div class="modal-body">
        <pre><code class="tex hljs"></code></pre>
      </div>
      <div class="modal-footer">
        <a class="btn btn-outline-primary my-1 js-copy-cite" href="#" target="_blank">
          <i class="fas fa-copy"></i> Copy
        </a>
        <a class="btn btn-outline-primary my-1 js-download-cite" href="#" target="_blank">
          <i class="fas fa-download"></i> Download
        </a>
        <div id="modal-error"></div>
      </div>
    </div>
  </div>
</div>

</body>
</html>
