<!DOCTYPE html>
<html lang="en-us">

<head>

  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="generator" content="Source Themes Academic 4.6.2">

  

  
  
  
  
  
    
    
    
  
  

  <meta name="author" content="Shreyansh Singh">

  
  
  
    
  
  <meta name="description" content="A bit late for writeups, but still here are the solutions to the challenges I solved during the CTF. The CTF was from 15 Nov. 2019, 22:30 IST — Mon, 18 Nov. 2019, 10:30 IST. It was a decent CTF with quality challenges, from both beginner to advanced level.
Update: The scripts to solve and the flags are present in this repo.
I&#39;ll do the writeups category-wise -
 Crypto  pre-legend — 100 pts">

  
  <link rel="alternate" hreflang="en-us" href="/post/2019-11-19_ritsec-ctf-2019/">

  


  
  
  
  <meta name="theme-color" content="#3f51b5">
  

  
  
  
  
    
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/academicons/1.8.6/css/academicons.min.css" integrity="sha256-uFVgMKfistnJAfoCUQigIl+JfUaP47GrRKjf6CTPVmw=" crossorigin="anonymous">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.11.2/css/all.min.css" integrity="sha256-+N4/V/SbAFiW1MPBCXnfnP9QSN3+Keu+NlB+0ev/YKQ=" crossorigin="anonymous">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/fancybox/3.5.7/jquery.fancybox.min.css" integrity="sha256-Vzbj7sDDS/woiFS3uNKo8eIuni59rjyNGtXfstRzStA=" crossorigin="anonymous">

    
    
    
      
    
    
      
      
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.15.10/styles/github.min.css" crossorigin="anonymous" title="hl-light">
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.15.10/styles/github.min.css" crossorigin="anonymous" title="hl-dark" disabled>
      
    

    
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/leaflet/1.5.1/leaflet.css" integrity="sha256-SHMGCYmST46SoyGgo4YR/9AlK1vf3ff84Aq9yK4hdqM=" crossorigin="anonymous">
    

    

  

  
  
  
  <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=B612+Mono:400,700%7COrbitron:400,700%7CSpace+Mono:400,700%7CLato%7CMontserrat%7CInconsolata%7COpen+Sans&display=swap">
  

  
  
  
  
  <link rel="stylesheet" href="/css/academic.css">

  





<script async src="https://www.googletagmanager.com/gtag/js?id=UA-153509490-1"></script>
<script>
  window.dataLayer = window.dataLayer || [];

  function gtag() {
      dataLayer.push(arguments);
  }

  function trackOutboundLink(url) {
    gtag('event', 'click', {
         'event_category': 'outbound',
         'event_label': url,
         'transport_type': 'beacon',
         'event_callback': function () {
           document.location = url;
         }
    });
    console.debug("Outbound link clicked: " + url);
  }

  function onClickCallback(event) {
    if ((event.target.tagName !== 'A') || (event.target.host === window.location.host)) {
      return;
    }
    trackOutboundLink(event.target);  
  }

  gtag('js', new Date());
  gtag('config', 'UA-153509490-1', {});

  
  document.addEventListener('click', onClickCallback, false);
</script>


  


  

  <link rel="manifest" href="/index.webmanifest">
  <link rel="icon" type="image/png" href="/img/shreyansh-icon-32.png">
  <link rel="apple-touch-icon" type="image/png" href="/img/shreyansh-icon-192.png">

  <link rel="canonical" href="/post/2019-11-19_ritsec-ctf-2019/">

  
  
  
  
    
  
  
  <meta property="twitter:card" content="summary_large_image">
  
  <meta property="twitter:site" content="@shreyansh_26">
  <meta property="twitter:creator" content="@shreyansh_26">
  
  <meta property="og:site_name" content="Shreyansh Singh">
  <meta property="og:url" content="/post/2019-11-19_ritsec-ctf-2019/">
  <meta property="og:title" content="RITSEC CTF 2019 | Shreyansh Singh">
  <meta property="og:description" content="A bit late for writeups, but still here are the solutions to the challenges I solved during the CTF. The CTF was from 15 Nov. 2019, 22:30 IST — Mon, 18 Nov. 2019, 10:30 IST. It was a decent CTF with quality challenges, from both beginner to advanced level.
Update: The scripts to solve and the flags are present in this repo.
I&#39;ll do the writeups category-wise -
 Crypto  pre-legend — 100 pts"><meta property="og:image" content="/post/2019-11-19_ritsec-ctf-2019/featured.png">
  <meta property="twitter:image" content="/post/2019-11-19_ritsec-ctf-2019/featured.png"><meta property="og:locale" content="en-us">
  
    
      <meta property="article:published_time" content="2019-11-19T17:31:59&#43;00:00">
    
    <meta property="article:modified_time" content="2019-11-29T21:04:58&#43;05:30">
  

  


    






  






<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "BlogPosting",
  "mainEntityOfPage": {
    "@type": "WebPage",
    "@id": "/post/2019-11-19_ritsec-ctf-2019/"
  },
  "headline": "RITSEC CTF 2019",
  
  "image": [
    "/post/2019-11-19_ritsec-ctf-2019/featured.png"
  ],
  
  "datePublished": "2019-11-19T17:31:59Z",
  "dateModified": "2019-11-29T21:04:58+05:30",
  
  "author": {
    "@type": "Person",
    "name": "Shreyansh Singh"
  },
  
  "publisher": {
    "@type": "Organization",
    "name": "Shreyansh Singh",
    "logo": {
      "@type": "ImageObject",
      "url": "/img/shreyansh-icon-512.png"
    }
  },
  "description": "A bit late for writeups, but still here are the solutions to the challenges I solved during the CTF. The CTF was from 15 Nov. 2019, 22:30 IST — Mon, 18 Nov. 2019, 10:30 IST. It was a decent CTF with quality challenges, from both beginner to advanced level.\nUpdate: The scripts to solve and the flags are present in this repo.\nI'll do the writeups category-wise -\n Crypto  pre-legend — 100 pts"
}
</script>

  

  


  


  

<style>

    @font-face {
        font-family: monaco123;
        font-weight: 100%;
        font-style: normal;
        src: url("/fonts/MONACO.TTF");
    } 

    code {
        font-family: monaco123;
        font-size: 100%;
    }

</style>


  <title>RITSEC CTF 2019 | Shreyansh Singh</title>

</head>

<body id="top" data-spy="scroll" data-offset="70" data-target="#TableOfContents" >

  <aside class="search-results" id="search">
  <div class="container">
    <section class="search-header">

      <div class="row no-gutters justify-content-between mb-3">
        <div class="col-6">
          <h1>Search</h1>
        </div>
        <div class="col-6 col-search-close">
          <a class="js-search" href="#"><i class="fas fa-times-circle text-muted" aria-hidden="true"></i></a>
        </div>
      </div>

      <div id="search-box">
        
        <input name="q" id="search-query" placeholder="Search..." autocapitalize="off"
        autocomplete="off" autocorrect="off" spellcheck="false" type="search">
        
      </div>

    </section>
    <section class="section-search-results">

      <div id="search-hits">
        
      </div>

    </section>
  </div>
</aside>


  
<nav class="navbar navbar-expand-lg navbar-light compensate-for-scrollbar" id="navbar-main">
  <div class="container">

    
    
    
      <a class="navbar-brand" href="/">Shreyansh Singh</a>
    

    
    <button type="button" class="navbar-toggler" data-toggle="collapse"
            data-target="#navbar-content" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
    <span><i class="fas fa-bars"></i></span>
    </button>
    

    
    
    <div class="navbar-collapse main-menu-item collapse justify-content-start" id="navbar-content">

      
      <ul class="navbar-nav d-md-inline-flex">
        

        

        
        
        
          
        

        
        
        
        
        
        
          
          
          
            
          
          
        

        <li class="nav-item">
          <a class="nav-link " href="/#about"><span>Home</span></a>
        </li>

        
        

        

        
        
        
          
        

        
        
        
        
        
        

        <li class="nav-item">
          <a class="nav-link  active" href="/post/"><span>Posts</span></a>
        </li>

        
        

        

        
        
        
          
        

        
        
        
        
        
        
          
          
          
            
          
          
        

        <li class="nav-item">
          <a class="nav-link " href="/#projects"><span>Projects</span></a>
        </li>

        
        

        

        
        
        
          
        

        
        
        
        
        
        
          
          
          
            
          
          
        

        <li class="nav-item">
          <a class="nav-link " href="/#contact"><span>Contact</span></a>
        </li>

        
        

        

        
        
        
          
        

        
        
        
        
        
        

        <li class="nav-item">
          <a class="nav-link " href="/files/Shreyansh_Resume.pdf"><span>CV</span></a>
        </li>

        
        

      

        
      </ul>
    </div>

    <ul class="nav-icons navbar-nav flex-row ml-auto d-flex pl-md-2">
      
      <li class="nav-item">
        <a class="nav-link js-search" href="#"><i class="fas fa-search" aria-hidden="true"></i></a>
      </li>
      

      
      <li class="nav-item">
        <a class="nav-link js-dark-toggle" href="#"><i class="fas fa-moon" aria-hidden="true"></i></a>
      </li>
      

      

    </ul>

  </div>
</nav>


  <article class="article">

  




















  
  


<div class="article-container pt-3">
  <h1>RITSEC CTF 2019</h1>

  
  <p class="page-subtitle">My writeups for RITSEC CTF 2019. A bit late, but I hope this helps someone!</p>
  

  


<div class="article-metadata">

  
  

  
  <span class="article-date">
    
    
      
          Last updated on
      
    
    Nov 29, 2019
  </span>
  

  

  
  <span class="middot-divider"></span>
  <span class="article-reading-time">
    6 min read
  </span>
  

  
  
  
  <span class="middot-divider"></span>
  <a href="/post/2019-11-19_ritsec-ctf-2019/#disqus_thread"></a>
  

  
  
  <span class="middot-divider"></span>
  <span class="article-categories">
    <i class="fas fa-folder mr-1"></i><a href="/categories/information-security/">Information Security</a></span>
  

</div>

  














</div>


<div class="article-header article-container featured-image-wrapper mt-4 mb-4" style="max-width: 589px; max-height: 534px;">
  <div style="position: relative">
    <img src="/post/2019-11-19_ritsec-ctf-2019/featured.png" alt="" class="featured-image">
    <span class="article-header-caption">RITSEC CTF 2019</span>
  </div>
</div>



  <div class="article-container">

    <div class="article-style">
      <p>A bit late for writeups, but still here are the solutions to the challenges I solved during the CTF. The CTF was from 15 Nov. 2019, 22:30 IST — Mon, 18 Nov. 2019, 10:30 IST. It was a decent CTF with quality challenges, from both beginner to advanced level.</p>
<p><strong>Update</strong>: The scripts to solve and the flags are present in <a href="https://github.com/wr47h/CTF-Writeups/tree/master/2019/RITSEC%20CTF%202019">this repo</a>.</p>
<p>I'll do the writeups category-wise -</p>
<hr>
<h2 id="crypto">Crypto</h2>
<p> <br>
<strong>pre-legend — 100 pts</strong></p>
<p><code>9EEADi^⁸:E9F3]4@&amp;gt;⁴=2J32==^D@&amp;gt;6E9:?8\FD67F=\C:ED64</code></p>
<p>This is the provided cipher text. Since all of these are ASCII characters, we try a ROT of till say, 50.</p>
<script type="application/javascript" src="https://gist.github.com/shreyansh26/e3386cba7303cdcb24b01d552b16aad4.js"></script>

<p>On i=47, we get — https\x98\x8d\x8dgithub\x8ccom\x8dclayball\x8dsomething\x8buseful\x8britsec</p>
<p>There is a problem with the special characters, but we understand that is a GitHub repo, with the URL (after some testing) — <a href="https://github.com/clayball/something-useful-ritsec"><a href="https://github.com/clayball/something-useful-ritsec">https://github.com/clayball/something-useful-ritsec</a></a>.</p>
<p>Although there is nothing flag related in the repo, but the discord group of the CTF said that the link itself is the flag.</p>
<p>Flag —<strong>RITSEC{https://github.com/clayball/something-useful-ritsec}</strong></p>
<p> <br>
<strong>Shiny — 100 pts</strong></p>
<p>We are given the following text, and an image
<code>.‡8]5);483‡5;</code></p>













<figure>


  <a data-fancybox="" href="https://cdn-images-1.medium.com/max/800/0*szkUp3DoP0hYUlyx" data-caption="gold-bug.jfif">
<img src="https://cdn-images-1.medium.com/max/800/0*szkUp3DoP0hYUlyx" alt="" ></a>


  
  
  <figcaption>
    gold-bug.jfif
  </figcaption>


</figure>

<p>This did not hit me directly, so I had to do a bit of Googling. I found that this is a reference to a short story by Edgar Allan Poe, called The Gold Bug which involves a substitution cipher. I found an <a href="https://www.dcode.fr/gold-bug-poe">online tool</a> for the same.</p>
<p>This gives us the flag —<strong>RITSEC{POEWASTHEGOAT}</strong></p>
<p> <br>
<strong>random — 290 pts</strong></p>
<p>After connecting to <em>nc ctfchallenges.ritsec.club 8001</em> we find that we are presented with a series of numbers and we have to guess the next. The challenge title tells us that we have something to do with the <strong>random</strong> function in the <strong>C</strong> language, because of the hint,</p>
<blockquote>
<p>Are you starting to &lsquo;C&rsquo; a pattern?</p>
</blockquote>
<p>We make a guess that whenever we request that host and port, the random function is initialized with a certain seed and we are given the first five random numbers generated from that seed. So, I wrote a simple C code to bruteforce all unix timestamps from 15th Nov 2019, 00:00 UTC to 17th Nov. 2019 00:00 UTC, and check for the seed. The code is shown below —</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-cpp" data-lang="cpp"><span style="color:#75715e">#</span><span style="color:#75715e">include</span> <span style="color:#75715e">&lt;stdio.h&gt;</span><span style="color:#75715e">
</span><span style="color:#75715e"></span><span style="color:#75715e">#</span><span style="color:#75715e">include</span> <span style="color:#75715e">&lt;stdlib.h&gt;</span><span style="color:#75715e">
</span><span style="color:#75715e"></span>
<span style="color:#66d9ef">int</span> <span style="color:#a6e22e">main</span>() {
    <span style="color:#66d9ef">int</span> start <span style="color:#f92672">=</span> <span style="color:#ae81ff">1573776000</span>;  <span style="color:#75715e">// 15th Nov 2019, 00:00 UTC
</span><span style="color:#75715e"></span>    <span style="color:#66d9ef">int</span> end <span style="color:#f92672">=</span> <span style="color:#ae81ff">1573948800</span>;  <span style="color:#75715e">// // 17th Nov 2019, 00:00 UTC
</span><span style="color:#75715e"></span>    <span style="color:#66d9ef">for</span>(<span style="color:#66d9ef">int</span> i<span style="color:#f92672">=</span>start; i<span style="color:#f92672">&lt;</span>end; i<span style="color:#f92672">+</span><span style="color:#f92672">+</span>) {
        srand(i);
        <span style="color:#66d9ef">int</span> a <span style="color:#f92672">=</span> rand();
        <span style="color:#66d9ef">int</span> b <span style="color:#f92672">=</span> rand();
        <span style="color:#66d9ef">int</span> c <span style="color:#f92672">=</span> rand();
        <span style="color:#66d9ef">int</span> d <span style="color:#f92672">=</span> rand();
        <span style="color:#66d9ef">int</span> e <span style="color:#f92672">=</span> rand();
        <span style="color:#66d9ef">int</span> f <span style="color:#f92672">=</span> rand();
        <span style="color:#66d9ef">if</span>(a<span style="color:#f92672">=</span><span style="color:#f92672">=</span><span style="color:#ae81ff">1068399227</span> <span style="color:#f92672">&amp;</span><span style="color:#f92672">&amp;</span> b<span style="color:#f92672">=</span><span style="color:#f92672">=</span><span style="color:#ae81ff">161933545</span> <span style="color:#f92672">&amp;</span><span style="color:#f92672">&amp;</span> c<span style="color:#f92672">=</span><span style="color:#f92672">=</span><span style="color:#ae81ff">741438783</span> <span style="color:#f92672">&amp;</span><span style="color:#f92672">&amp;</span> d<span style="color:#f92672">=</span><span style="color:#f92672">=</span><span style="color:#ae81ff">1951874661</span> <span style="color:#f92672">&amp;</span><span style="color:#f92672">&amp;</span> e<span style="color:#f92672">=</span><span style="color:#f92672">=</span><span style="color:#ae81ff">1076387813</span>) {
            printf(<span style="color:#e6db74"></span><span style="color:#e6db74">&#34;</span><span style="color:#e6db74">Seed: %d</span><span style="color:#ae81ff">\n</span><span style="color:#e6db74">&#34;</span>, i);
            printf(<span style="color:#e6db74"></span><span style="color:#e6db74">&#34;</span><span style="color:#e6db74">Next: %d</span><span style="color:#ae81ff">\n</span><span style="color:#e6db74">&#34;</span>, f);
            <span style="color:#66d9ef">break</span>;
        }
    }
    <span style="color:#66d9ef">return</span> <span style="color:#ae81ff">0</span>;
}
</code></pre></div><p>We provide the next number, and get the flag — <strong>RITSEC{404_RANDOMNESS_NOT_FOUND}</strong></p>
<hr>
<h2 id="misc">Misc</h2>
<p> <br>
<strong>Crack me If You Can — 391 pts</strong></p>
<p>In this challenge, after connecting to <em>nc ctfchallenges.ritsec.club 8080</em>, we find that we are presented with queries of hashes, and we have to break them in order to get the flag. They were NTLM and sha256 hashes. So, we used a combination of <a href="http://crackstation.net">crackstation.net</a> and John the Ripper to crack both of them.</p>
<p>We found the flag — <strong>RS{H@$HM31FY0UCAN}</strong></p>
<p> <br>
<strong>Onion Layer Encoding — 100 pts</strong></p>
<p>The challenge says that the text is encoded using either Base16 or Baser32 or Base64 in a sequence. So we write a simple python script to solve it.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#f92672">import</span> base64

flag <span style="color:#f92672">=</span> open(<span style="color:#e6db74"></span><span style="color:#e6db74">&#34;</span><span style="color:#e6db74">onionlayerencoding.txt</span><span style="color:#e6db74">&#34;</span>,<span style="color:#e6db74"></span><span style="color:#e6db74">&#34;</span><span style="color:#e6db74">r</span><span style="color:#e6db74">&#34;</span>)<span style="color:#f92672">.</span>read()

<span style="color:#66d9ef">while</span> <span style="color:#e6db74"></span><span style="color:#e6db74">&#34;</span><span style="color:#e6db74">RITSEC</span><span style="color:#e6db74">&#34;</span> <span style="color:#f92672">not</span> <span style="color:#f92672">in</span> str(flag):
    <span style="color:#66d9ef">try</span>:
        flag <span style="color:#f92672">=</span> base64<span style="color:#f92672">.</span>b16decode(flag)
    <span style="color:#66d9ef">except</span>:
        <span style="color:#66d9ef">try</span>:
            flag <span style="color:#f92672">=</span> base64<span style="color:#f92672">.</span>b32decode(flag)
        <span style="color:#66d9ef">except</span>:
            flag <span style="color:#f92672">=</span> base64<span style="color:#f92672">.</span>b64decode(flag)
            
<span style="color:#66d9ef">print</span>(flag)
</code></pre></div><p>The flag is — <strong>RITSEC{0n1On_L4y3R}</strong></p>
<p> <br>
<strong>AlPhAbEtIcAl Challenge - 100pts</strong></p>
<p>I couldn't solve this during the CTF, but saw other writeups and found that it was actually pretty interesting. The cipher text that is provided is —</p>
<blockquote>
<p>59:87:57:51:85:80{:40:50:56:08:82:58:81:08:18:85:57:87:48:85:88:40:50:56:59:15:56:11:18:85:59:51:}</p>
</blockquote>
<p>We see that the &lsquo;{&rsquo; and &lsquo;}&rsquo; are in place. So, this must represent the flag. The other numbers are assigned some alphabet starting from &lsquo;A&rsquo;. After this we see that we have the following — ABCDEF{GHIJKLMJNECBOEPGHIAQIRNEAD}.</p>
<p>On this we use an online substitution solver like quipquip.com and also the fact that ABCDEF corresponds to RITSEC, we get the flag as — <strong>RITSEC{YOUALPHABETIZEDYOURNUMBERS}</strong></p>
<hr>
<h2 id="web">Web</h2>
<p> <br>
<strong>misdirection — 100 pts</strong></p>
<p>We are given a URL — <a href="http://ctfchallenges.ritsec.club:5000/"><a href="http://ctfchallenges.ritsec.club:5000/">http://ctfchallenges.ritsec.club:5000/</a></a> However, on clicking it we see that we are directed to another webpage <a href="http://ctfchallenges.ritsec.club:5000/n"><a href="http://ctfchallenges.ritsec.club:5000/n">http://ctfchallenges.ritsec.club:5000/n</a></a> and the information that the webpage isn't redirecting properly. So, I decided to see what is happening, for that I did a simple <em>wget</em> to the url.</p>













<figure>


  <a data-fancybox="" href="/post/2019-11-19_ritsec-ctf-2019/images/3.png" data-caption="Running wget">
<img src="/post/2019-11-19_ritsec-ctf-2019/images/3.png" alt="" ></a>


  
  
  <figcaption>
    Running wget
  </figcaption>


</figure>

<p>We see that the page redirects to different pages and keeps doing that. We note that the last character is basically in the flag format when put together. We do that and get the flag — <strong>RS{4!way5_Ke3p-m0v1ng}</strong></p>
<p> <br>
<strong>Buckets of fun — 100 pts</strong></p>
<p>We are given the following URL — <a href="http://bucketsoffun-ctf.s3-website-us-east-1.amazonaws.com/"><a href="http://bucketsoffun-ctf.s3-website-us-east-1.amazonaws.com/">http://bucketsoffun-ctf.s3-website-us-east-1.amazonaws.com/</a></a></p>
<p>Taking a hint from the name of the challenge, we try the following URL in the browser —<a href="http://bucketsoffun-ctf.s3.amazonaws.com"><a href="http://bucketsoffun-ctf.s3.amazonaws.com">http://bucketsoffun-ctf.s3.amazonaws.com</a></a></p>













<figure>


  <a data-fancybox="" href="/post/2019-11-19_ritsec-ctf-2019/images/4.png" data-caption="The webpage">
<img src="/post/2019-11-19_ritsec-ctf-2019/images/4.png" alt="" ></a>


  
  
  <figcaption>
    The webpage
  </figcaption>


</figure>

<p>We see a file <strong>youfoundme-asd897kjm.txt</strong></p>
<p>Heading to <a href="http://bucketsoffun-ctf.s3.amazonaws.com/youfoundme-asd897kjm.txt"><a href="http://bucketsoffun-ctf.s3.amazonaws.com/youfoundme-asd897kjm.txt">http://bucketsoffun-ctf.s3.amazonaws.com/youfoundme-asd897kjm.txt</a></a> we find the flag — <strong>RITSEC{LIST_HIDDEN_FILES}</strong></p>
<hr>
<h2 id="forensics">Forensics</h2>
<p> <br>
<strong>Take it to the Cleaners — 100 pts</strong></p>
<p>We are given an image</p>













<figure>


  <a data-fancybox="" href="/post/2019-11-19_ritsec-ctf-2019/images/5.png" data-caption="The challenge">
<img src="/post/2019-11-19_ritsec-ctf-2019/images/5.png" alt="" ></a>


  
  
  <figcaption>
    The challenge
  </figcaption>


</figure>

<p>Performing basic recon, we check the metadata for the image using exiftool.</p>













<figure>


  <a data-fancybox="" href="/post/2019-11-19_ritsec-ctf-2019/images/6.png" data-caption="exiftool output">
<img src="/post/2019-11-19_ritsec-ctf-2019/images/6.png" alt="" ></a>


  
  
  <figcaption>
    exiftool output
  </figcaption>


</figure>

<p>In the user comment, we see a string which is probably base64 encoded.</p>
<p>Decoding it gives, <strong>EVGFRP{SBERAFVPF_SNVYF_JBAG_URYC_LBH_URER}</strong></p>
<p>Looks rotated by an offset. We use <a href="http://theblob.org/rot.cgi"><a href="http://theblob.org/rot.cgi">http://theblob.org/rot.cgi</a></a> to get rotations by different offsets. This is ROT13 and the flag is — <strong>RITSEC{FORENSICS_FAILS_WONT_HELP_YOU_HERE}</strong></p>
<p> <br>
<strong>Long Gone — 100 pts</strong></p>
<p>We are provided a chromebin. Extract it as it is a tar archive.</p>
<blockquote>
<p>tar xzvf ./chromebin</p>
</blockquote>
<p>We see there are a lot of folders, on inspecting the history we find it is an SQLite 3.X database. Loading it into DBBrowser, and inspecting the tables, shows an odd URL — us-central-1.ritsec.club/l/relaxfizzblur</p>
<p>Opening the url gives the flag — <strong>RITSEC{SP00KY_BR0WS3R_H1ST0RY}</strong></p>
<hr>
<h2 id="pwn">Pwn</h2>
<p> <br>
<strong>999 Bottles — 110 pts</strong></p>
<p>We are given 999 ELF files, each having a password as a single character. Basically, 999 crackmes with a one character password. If we check the disassembly of main function of any one —</p>













<figure>


  <a data-fancybox="" href="/post/2019-11-19_ritsec-ctf-2019/images/7.png" data-caption="The disassembly for main">
<img src="/post/2019-11-19_ritsec-ctf-2019/images/7.png" alt="" ></a>


  
  
  <figcaption>
    The disassembly for main
  </figcaption>


</figure>

<p>At 0x8048728 we see a comparison, where register edx (dl) stores our input character and eax (al) stores the value at address 0x804a039.</p>
<p>Also, in the disassembly, we have some character mappings to addresses —</p>













<figure>


  <a data-fancybox="" href="/post/2019-11-19_ritsec-ctf-2019/images/8.png" data-caption="Character mappings">
<img src="/post/2019-11-19_ritsec-ctf-2019/images/8.png" alt="" ></a>


  
  
  <figcaption>
    Character mappings
  </figcaption>


</figure>

<p>So, one way to solve this challenge is to get the address to be compared and check the character at this address and automate it somehow.</p>
<p>During the CTF, however, I wrote a bruteforce script to try all characters for every ELF file.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#f92672">from</span> pwn <span style="color:#f92672">import</span> <span style="color:#f92672">*</span>
<span style="color:#f92672">import</span> string

FOLDER <span style="color:#f92672">=</span> <span style="color:#e6db74"></span><span style="color:#e6db74">&#39;</span><span style="color:#e6db74">./elfs/</span><span style="color:#e6db74">&#39;</span>
filenames <span style="color:#f92672">=</span> []
s <span style="color:#f92672">=</span> string<span style="color:#f92672">.</span>digits <span style="color:#f92672">+</span> string<span style="color:#f92672">.</span>letters <span style="color:#f92672">+</span> string<span style="color:#f92672">.</span>punctuation

<span style="color:#66d9ef">for</span> i <span style="color:#f92672">in</span> range(<span style="color:#ae81ff">1</span>,<span style="color:#ae81ff">1000</span>):
    filenames<span style="color:#f92672">.</span>append(str(i)<span style="color:#f92672">.</span>zfill(<span style="color:#ae81ff">3</span>) <span style="color:#f92672">+</span> <span style="color:#e6db74"></span><span style="color:#e6db74">&#39;</span><span style="color:#e6db74">.c.out</span><span style="color:#e6db74">&#39;</span>)flag <span style="color:#f92672">=</span> <span style="color:#e6db74"></span><span style="color:#e6db74">&#39;</span><span style="color:#e6db74">&#39;</span>
f <span style="color:#f92672">=</span> open(<span style="color:#e6db74"></span><span style="color:#e6db74">&#39;</span><span style="color:#e6db74">flag.txt</span><span style="color:#e6db74">&#39;</span>, <span style="color:#e6db74"></span><span style="color:#e6db74">&#39;</span><span style="color:#e6db74">w</span><span style="color:#e6db74">&#39;</span>)
<span style="color:#66d9ef">for</span> file <span style="color:#f92672">in</span> filenames:
    <span style="color:#66d9ef">for</span> inp <span style="color:#f92672">in</span> s:
        p <span style="color:#f92672">=</span> process(FOLDER<span style="color:#f92672">+</span>file)
        p<span style="color:#f92672">.</span>recv()
        p<span style="color:#f92672">.</span>sendline(inp)
        a <span style="color:#f92672">=</span> p<span style="color:#f92672">.</span>recvline()
        <span style="color:#66d9ef">if</span> <span style="color:#e6db74"></span><span style="color:#e6db74">&#39;</span><span style="color:#e6db74">OK!</span><span style="color:#e6db74">&#39;</span> <span style="color:#f92672">in</span> a:
            flag <span style="color:#f92672">+</span><span style="color:#f92672">=</span> inp
            p<span style="color:#f92672">.</span>close()
            <span style="color:#66d9ef">print</span>(<span style="color:#e6db74"></span><span style="color:#e6db74">&#34;</span><span style="color:#e6db74">FLAG: </span><span style="color:#e6db74">&#34;</span> <span style="color:#f92672">+</span> flag)
            f<span style="color:#f92672">.</span>write(<span style="color:#e6db74"></span><span style="color:#e6db74">&#34;</span><span style="color:#e6db74">FLAG: </span><span style="color:#e6db74">&#34;</span> <span style="color:#f92672">+</span> flag)
            f<span style="color:#f92672">.</span>write(<span style="color:#e6db74"></span><span style="color:#e6db74">&#39;</span><span style="color:#ae81ff">\n</span><span style="color:#e6db74">&#39;</span>)
            <span style="color:#66d9ef">break</span>
        <span style="color:#66d9ef">else</span>:
            p<span style="color:#f92672">.</span>close()
            
f<span style="color:#f92672">.</span>write(<span style="color:#e6db74"></span><span style="color:#e6db74">&#34;</span><span style="color:#e6db74">FLAG: </span><span style="color:#e6db74">&#34;</span> <span style="color:#f92672">+</span> flag)
<span style="color:#66d9ef">print</span>(flag)
f<span style="color:#f92672">.</span>close()
</code></pre></div><p>Finally, we have the following string in the output generated -</p>
<blockquote>
<p>lr^wN${HnW&lt;DtVjk.RITSEC{AuT057v}^W!xT</p>
</blockquote>
<p>Note the string in the flag format, that is the flag — <strong>RITSEC{AuT057v}</strong></p>
<p>A better way to solve it actually using the method described above. The following script can help do that -</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#f92672">import</span> r2pipe  
<span style="color:#f92672">import</span> binascii  
<span style="color:#f92672">import</span> sys

<span style="color:#66d9ef">for</span> i <span style="color:#f92672">in</span> range(<span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">1000</span>):  
    <span style="color:#66d9ef">print</span>(<span style="color:#e6db74"></span><span style="color:#e6db74">&#39;</span><span style="color:#e6db74">elfs/{0:03}</span><span style="color:#e6db74">&#39;</span><span style="color:#f92672">.</span>format(i))  
    b <span style="color:#f92672">=</span> r2pipe<span style="color:#f92672">.</span>open(<span style="color:#e6db74"></span><span style="color:#e6db74">&#39;</span><span style="color:#e6db74">elfs/{0:03}</span><span style="color:#e6db74">&#39;</span><span style="color:#f92672">.</span>format(i) <span style="color:#f92672">+</span> <span style="color:#e6db74"></span><span style="color:#e6db74">&#39;</span><span style="color:#e6db74">.c.out</span><span style="color:#e6db74">&#39;</span>)

    disass <span style="color:#f92672">=</span> b<span style="color:#f92672">.</span>cmd(<span style="color:#e6db74"></span><span style="color:#e6db74">&#39;</span><span style="color:#e6db74">aaa; s main; pdd</span><span style="color:#e6db74">&#39;</span>)  
    field <span style="color:#f92672">=</span> disass<span style="color:#f92672">.</span>split(<span style="color:#e6db74"></span><span style="color:#e6db74">&#34;</span><span style="color:#e6db74">eax = *(obj.</span><span style="color:#e6db74">&#34;</span>)[<span style="color:#ae81ff">1</span>][<span style="color:#ae81ff">0</span>]  
    byte <span style="color:#f92672">=</span> disass<span style="color:#f92672">.</span>split(f<span style="color:#e6db74"></span><span style="color:#e6db74">&#39;</span><span style="color:#e6db74">*(obj.{field}) = </span><span style="color:#e6db74">&#39;</span>)[<span style="color:#f92672">-</span><span style="color:#ae81ff">1</span>][<span style="color:#ae81ff">2</span>:<span style="color:#ae81ff">4</span>]  
    <span style="color:#66d9ef">print</span>(binascii<span style="color:#f92672">.</span>unhexlify(byte)<span style="color:#f92672">.</span>decode(<span style="color:#e6db74"></span><span style="color:#e6db74">&#39;</span><span style="color:#e6db74">ascii</span><span style="color:#e6db74">&#39;</span>), sep<span style="color:#f92672">=</span><span style="color:#e6db74"></span><span style="color:#e6db74">&#39;</span><span style="color:#e6db74">&#39;</span>)
</code></pre></div><p>This is all. Thanks for reading!</p>
<p>Follow me on <a href="https://twitter.com/shreyansh_26">Twitter</a>, <a href="https://github.com/shreyansh26">Github</a> or connect on <a href="https://www.linkedin.com/in/shreyansh26/">LinkedIn</a>.</p>

    </div>

    





<div class="article-tags">
  
  <a class="badge badge-light" href="/tags/ctf/">ctf</a>
  
  <a class="badge badge-light" href="/tags/information-security/">information security</a>
  
  <a class="badge badge-light" href="/tags/infosec/">infosec</a>
  
  <a class="badge badge-light" href="/tags/writeups/">writeups</a>
  
</div>



<div class="share-box" aria-hidden="true">
  <ul class="share">
    
      
      
      
        
      
      
      
      <li>
        <a href="https://twitter.com/intent/tweet?url=/post/2019-11-19_ritsec-ctf-2019/&amp;text=RITSEC%20CTF%202019" target="_blank" rel="noopener" class="share-btn-twitter">
          <i class="fab fa-twitter"></i>
        </a>
      </li>
    
      
      
      
        
      
      
      
      <li>
        <a href="https://www.facebook.com/sharer.php?u=/post/2019-11-19_ritsec-ctf-2019/&amp;t=RITSEC%20CTF%202019" target="_blank" rel="noopener" class="share-btn-facebook">
          <i class="fab fa-facebook"></i>
        </a>
      </li>
    
      
      
      
        
      
      
      
      <li>
        <a href="mailto:?subject=RITSEC%20CTF%202019&amp;body=/post/2019-11-19_ritsec-ctf-2019/" target="_blank" rel="noopener" class="share-btn-email">
          <i class="fas fa-envelope"></i>
        </a>
      </li>
    
      
      
      
        
      
      
      
      <li>
        <a href="https://www.linkedin.com/shareArticle?url=/post/2019-11-19_ritsec-ctf-2019/&amp;title=RITSEC%20CTF%202019" target="_blank" rel="noopener" class="share-btn-linkedin">
          <i class="fab fa-linkedin-in"></i>
        </a>
      </li>
    
      
      
      
        
      
      
      
      <li>
        <a href="https://web.whatsapp.com/send?text=RITSEC%20CTF%202019%20/post/2019-11-19_ritsec-ctf-2019/" target="_blank" rel="noopener" class="share-btn-whatsapp">
          <i class="fab fa-whatsapp"></i>
        </a>
      </li>
    
  </ul>
</div>












  






  
  
  
    
  
  
  <div class="media author-card content-widget-hr">
    
      
      <img class="portrait mr-3" src="/authors/admin/avatar_huf7b68353d7bcc081ff7af0a8e00b9689_37035_250x250_fill_q90_lanczos_center.jpg" alt="Avatar">
    

    <div class="media-body">
      <h5 class="card-title"><a href="/">Shreyansh Singh</a></h5>
      <h6 class="card-subtitle">Senior Undergraduate in Computer Science and Engineering</h6>
      <p class="card-text">My research interests include information security, specially binary analysis and also application of Machine Learning in security.</p>
      <ul class="network-icon" aria-hidden="true">
  
    
    
    
      
    
    
    
    
    
    <li>
      <a href="mailto:shreyansh.singh.cse16@iitbhu.ac.in" >
        <i class="fas fa-envelope"></i>
      </a>
    </li>
  
    
    
    
      
    
    
    
    
    
      
    
    <li>
      <a href="https://twitter.com/shreyansh_26" target="_blank" rel="noopener">
        <i class="fab fa-twitter"></i>
      </a>
    </li>
  
    
    
    
    
    
    
    
      
    
    <li>
      <a href="https://scholar.google.com/citations?user=x8LmoJIAAAAJ&amp;hl=en" target="_blank" rel="noopener">
        <i class="ai ai-google-scholar"></i>
      </a>
    </li>
  
    
    
    
      
    
    
    
    
    
      
    
    <li>
      <a href="https://github.com/shreyansh26" target="_blank" rel="noopener">
        <i class="fab fa-github"></i>
      </a>
    </li>
  
    
    
    
      
    
    
    
    
    
      
    
    <li>
      <a href="https://www.linkedin.com/in/shreyansh26/" target="_blank" rel="noopener">
        <i class="fab fa-linkedin"></i>
      </a>
    </li>
  
    
    
    
    
    
    
    
      
    
    <li>
      <a href="/files/Shreyansh_Resume.pdf" >
        <i class="ai ai-cv"></i>
      </a>
    </li>
  
</ul>

    </div>
  </div>




<section id="comments">
  
    
<div id="disqus_thread"></div>
<script>
  let disqus_config = function () {
    
    
    
  };
  (function() {
    if (["localhost", "127.0.0.1"].indexOf(window.location.hostname) != -1) {
      document.getElementById('disqus_thread').innerHTML = 'Disqus comments not available by default when the website is previewed locally.';
      return;
    }
    var d = document, s = d.createElement('script'); s.async = true;
    s.src = 'https://' + "shreyansh26-netlify-com" + '.disqus.com/embed.js';
    s.setAttribute('data-timestamp', +new Date());
    (d.head || d.body).appendChild(s);
  })();
</script>
<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
<a href="https://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>


  
</section>




<div class="article-widget">
  
<div class="post-nav">
  
  
  
  <div class="post-nav-item">
    <div class="meta-nav">Next</div>
    <a href="/post/2019-12-02_tuctf-pwn-2019/" rel="next">TUCTF 2019 - Pwn Challenges</a>
  </div>
  
  
  
  <div class="post-nav-item">
    <div class="meta-nav">Previous</div>
    <a href="/post/2019-08-25_codefest19-ctf-writeups/" rel="prev">Codefest’19 CTF Writeups</a>
  </div>
  
</div>

</div>



  
  
  <div class="article-widget content-widget-hr">
    <h3>Related</h3>
    <ul>
      
      <li><a href="/post/2019-08-25_codefest19-ctf-writeups/">Codefest’19 CTF Writeups</a></li>
      
      <li><a href="/post/2018-03-23_angstromctf-writeups/">AngstromCTF Writeups</a></li>
      
      <li><a href="/post/2018-02-27_neverlan-ctf-2018-writeups/">NeverLAN CTF 2018 Writeups</a></li>
      
      <li><a href="/project/nids/">Network Intrusion Detection in an Adversarial setting</a></li>
      
      <li><a href="/project/linux-malware/">Linux Malware detection using Machine Learning</a></li>
      
    </ul>
  </div>
  



  </div>
</article>

      

    
    

    
    
    
      <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
      <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery.imagesloaded/4.1.4/imagesloaded.pkgd.min.js" integrity="sha256-lqvxZrPLtfffUl2G/e7szqSvPBILGbwmsGE1MKlOi0Q=" crossorigin="anonymous"></script>
      <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery.isotope/3.0.6/isotope.pkgd.min.js" integrity="sha256-CBrpuqrMhXwcLLUd5tvQ4euBHCdh7wGlDfNz8vbu/iI=" crossorigin="anonymous"></script>
      <script src="https://cdnjs.cloudflare.com/ajax/libs/fancybox/3.5.7/jquery.fancybox.min.js" integrity="sha256-yt2kYMy0w8AbtF89WXb2P1rfjcP/HTHLT7097U8Y5b8=" crossorigin="anonymous"></script>

      

      
        
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.15.10/highlight.min.js" integrity="sha256-1zu+3BnLYV9LdiY85uXMzii3bdrkelyp37e0ZyTAQh0=" crossorigin="anonymous"></script>
        
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.15.10/languages/r.min.js"></script>
        
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.15.10/languages/python.min.js"></script>
        
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.15.10/languages/cpp.min.js"></script>
        
      

      
      
    

    
    
      <script src="https://cdnjs.cloudflare.com/ajax/libs/leaflet/1.5.1/leaflet.js" integrity="sha256-EErZamuLefUnbMBQbsEqu1USa+btR2oIlCpBJbyD4/g=" crossorigin="anonymous"></script>
    

    
    
    <script>const code_highlighting = true;</script>
    

    
    
    
    
    
    
    <script>
      const search_config = {"indexURI":"/index.json","minLength":1,"threshold":0.3};
      const i18n = {"no_results":"No results found","placeholder":"Search...","results":"results found"};
      const content_type = {
        'post': "Posts",
        'project': "Projects",
        'publication' : "Publications",
        'talk' : "Talks"
        };
    </script>
    

    
    

    
    
    <script id="search-hit-fuse-template" type="text/x-template">
      <div class="search-hit" id="summary-{{key}}">
      <div class="search-hit-content">
        <div class="search-hit-name">
          <a href="{{relpermalink}}">{{title}}</a>
          <div class="article-metadata search-hit-type">{{type}}</div>
          <p class="search-hit-description">{{snippet}}</p>
        </div>
      </div>
      </div>
    </script>
    

    
    
    <script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/3.2.1/fuse.min.js" integrity="sha256-VzgmKYmhsGNNN4Ph1kMW+BjoYJM2jV5i4IlFoeZA9XI=" crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/jquery.mark.min.js" integrity="sha256-4HLtjeVgH0eIB3aZ9mLYF6E8oU5chNdjU6p6rrXpl9U=" crossorigin="anonymous"></script>
    

    
    

    
    
    <script id="dsq-count-scr" src="https://shreyansh26-netlify-com.disqus.com/count.js" async></script>
    

    
    
    
    
    
    
    
    
    
      
    
    
    
    
    <script src="/js/academic.min.bcfae8267aba63cc55af53a503896bd9.js"></script>

    






  
  
  <div class="container">
    <footer class="site-footer">
  

  <p class="powered-by">
    © Shreyansh Singh 2019 &middot; 

    Powered by 
    
    <a href="https://gohugo.io" target="_blank" rel="noopener">Hugo</a>.

    
    <span class="float-right" aria-hidden="true">
      <a href="#" class="back-to-top">
        <span class="button_icon">
          <i class="fas fa-chevron-up fa-2x"></i>
        </span>
      </a>
    </span>
    
  </p>
</footer>

  </div>
  

  
<div id="modal" class="modal fade" role="dialog">
  <div class="modal-dialog">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title">Cite</h5>
        <button type="button" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <div class="modal-body">
        <pre><code class="tex hljs"></code></pre>
      </div>
      <div class="modal-footer">
        <a class="btn btn-outline-primary my-1 js-copy-cite" href="#" target="_blank">
          <i class="fas fa-copy"></i> Copy
        </a>
        <a class="btn btn-outline-primary my-1 js-download-cite" href="#" target="_blank">
          <i class="fas fa-download"></i> Download
        </a>
        <div id="modal-error"></div>
      </div>
    </div>
  </div>
</div>

</body>
</html>
